window.__require=function t(e,o,n){function i(r,c){if(!o[r]){if(!e[r]){var a=r.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+r+"'")}r=a}var u=o[r]={exports:{}};e[r][0].call(u.exports,function(t){return i(e[r][1][t]||t)},u,u.exports,t,e,o,n)}return o[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({appcontroller:[function(t,e,o){"use strict";cc._RF.push(e,"66abcS0EXdE0Y6u8dHK5lgA","appcontroller");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./appmodel"),r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}var o;return n(e,t),o=e,e.prototype.guid=function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.prototype.getRng=function(t,e){return Math.floor(t+Math.random()*(e-t+1))},e.prototype.onLoad=function(){this.model=s.default.instance,o.instance=this,cc.game.addPersistRootNode(this.node)},e.instance=null,e.isHidden=!1,e=o=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{"./appmodel":"appmodel"}],appmodel:[function(t,e,o){"use strict";cc._RF.push(e,"9d249BDClpGNaPsQFkyKoX1","appmodel"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./domain/player"),i=t("./domain/soundsettings"),s=t("./ui/soundmanager"),r=function(){function t(){this.player=null,this.table=null,this.sound_settings=null,this.players=new n.PlayerIM;var t=cc.sys.localStorage.getItem("soundSettings");this.updateSoundSettings(t?JSON.parse(t):new i.default(1,1,!0))}return t.prototype.updateSoundSettings=function(t){this.sound_settings=t,s.default.setMusicVolume(t.music_volume),s.default.setEffectsVolume(t.sfx_volume),s.default.setSoundEnabled(t.enabled)},t.prototype.saveSoundSettings=function(t){this.sound_settings=t,cc.sys.localStorage.setItem("soundSettings",JSON.stringify(t))},Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t._instance=null,t}();o.default=r,cc._RF.pop()},{"./domain/player":"player","./domain/soundsettings":"soundsettings","./ui/soundmanager":"soundmanager"}],chipComponent:[function(t,e,o){"use strict";cc._RF.push(e,"2c1e7MF7I5IG7wYeIOVPhgn","chipComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chipSprites=[],e.activeSprite=null,e.isBlockSelected=!1,e.chipId=0,e._isActive=!1,e}return n(e,t),e.prototype.start=function(){var t=this;this.activeSprite.active=!1,this.node.on("touchstart",function(){t.node.emit("selected",t.chipId)})},e.prototype.setActiveChip=function(t){this.node.getComponent(cc.Sprite).spriteFrame=this.chipSprites[t],this.chipId=t},e.prototype.selecte=function(){this.isBlockSelected||(this.activeSprite.active=!0,this._isActive=!0)},e.prototype.disable=function(){this.activeSprite.active=!1},i([c(cc.SpriteFrame)],e.prototype,"chipSprites",void 0),i([c(cc.Node)],e.prototype,"activeSprite",void 0),i([c(Boolean)],e.prototype,"isBlockSelected",void 0),e=i([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],chipsContainerComponent:[function(t,e,o){"use strict";cc._RF.push(e,"bfc68X4qVVJ+Ld4dK0Ivp7O","chipsContainerComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._chipsComponent=[],e.chipPrefab=null,e.arrowLeft=null,e.arrowRight=null,e._steps=0,e._step=0,e.mockData=[1,5,10,20,50,100,500,1e3,2e3,5e3],e.updateChipsList=function(){var t=[e._step-5,e._step],o=t[0],n=t[1];e._chipsComponent.forEach(function(t,e){t.node.active=e>=o&&e<n})},e}return n(e,t),e.prototype.applyModel=function(t){t&&t.removeObserver(this),t.addObserver(this),this.onObjectChanged(t)},e.prototype.onObjectChanged=function(t){console.log(t);var e=t.chips.find(function(t){return t.selected});console.log(e),e&&this._chipsComponent.forEach(function(t){console.log(t.chipId,e.id),t.chipId!==e.id?t.disable():t.selecte()}),this.model=t},e.prototype.start=function(){var t=this;this._step=5,console.log("_steps",this._steps),this.model.chips.forEach(function(e,o){var n=cc.instantiate(t.chipPrefab);t.node.addChild(n);var i=n.getComponent("chipComponent");console.log(i,e),i.setActiveChip(e.id),o>4&&(i.node.active=!1),t._chipsComponent.push(i)}),this._chipsComponent.forEach(function(e){e.node.on("selected",function(e){t.node.emit("selected",e)})}),this.arrowLeft.on("touchstart",function(){console.log("left"),5!==t._step&&(t._step--,t.updateChipsList())}),this.arrowRight.on("touchstart",function(){console.log("right"),t._step!==t.mockData.length&&(t._step++,t.updateChipsList())})},i([c(cc.Prefab)],e.prototype,"chipPrefab",void 0),i([c(cc.Node)],e.prototype,"arrowLeft",void 0),i([c(cc.Node)],e.prototype,"arrowRight",void 0),e=i([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],coin:[function(t,e,o){"use strict";cc._RF.push(e,"895f2CKRzlMEpIsl0CCZDro","coin"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t){this._value=0,this._active=!1,this._win=!1,this._id=t,console.log(this._type)}return t.prototype.getId=function(){return this._id},t.prototype.getType=function(){return this._type},t.prototype.getValue=function(){return this._value},t.prototype.isActive=function(){return this._active},t.prototype.isEmpty=function(){return"empty"===this._type},t.prototype.isPlus=function(){return"plus"===this._type},t.prototype.setWin=function(t){void 0===t&&(t=!1),this._win=t},t.prototype.setEmpty=function(t){this._type=t},t.prototype.setPlus=function(t){this._type=t},t.prototype.isWin=function(){return this._win},t.prototype.addValue=function(t){this._value+=t},t.prototype.activate=function(t,e){this._type=t,this._active=!0,this._value=e},t.prototype.disable=function(){this._type=void 0,this._active=!1},t}();o.default=n,cc._RF.pop()},{}],command:[function(t,e,o){"use strict";cc._RF.push(e,"cd553+MqUJL5b8eFMAiXkIK","command");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;e.args=[],e._isRunning=!0,e._isStarted=!1,e._resourcesReleased=!1,e._resolve=null,e._reject=null,e.promise=null,e.commands=[],e.destroyHandler=null;var o=e;return e.args=[],e.promise=new Promise(function(t,e){o._resolve=t,o._reject=e}),e}return n(e,t),e.prototype.start=function(){this._isRunning&&(this._isStarted=!0,this.onStart(this.args))},e.prototype.onStart=function(t){},e.prototype.update=function(t){this._isRunning&&this.onUpdate(t)},e.prototype.onUpdate=function(t){},e.executeOn=function(t,e,o,n){void 0===n&&(n=null);var i=e.addComponent(t);return i.args=o,n&&(n.commands.push(i),i.destroyHandler=n),i},e.prototype.onCommandDestroy=function(t){this.commands.splice(this.commands.indexOf(t),1)},e.prototype.finishCommand=function(t){void 0===t&&(t=!0),this._isRunning&&(this._isRunning=!1,this.onFinishCommand(t),this.destroy())},e.prototype.onFinishCommand=function(t){for(var e=this.commands.length;this.commands.length>0&&(e--,this.commands[0].finishCommand(t),0!==e););0!==this.commands.length&&cc.log("State does not finished all commands"),t?this._resolve(this):this._reject(this)},e.prototype.onReleaseResources=function(){},e.prototype.onDestroy=function(){var t=this.constructor?this.constructor.name:typeof this;if(cc.log("Command "+t+" destroyed"),!this._resourcesReleased&&this._isStarted){this.destroyHandler&&this.destroyHandler.onCommandDestroy(this);try{this.onReleaseResources()}catch(t){cc.log("Error during release command resources "+t.toString())}this._resourcesReleased=!0}else cc.warn("Resource release for command "+t+" skipped, started:"+this._isStarted+", released:"+this._resourcesReleased)},e.prototype.terminate=function(){this.finishCommand(!1)},e}(cc.Component);o.default=i,cc._RF.pop()},{}],dicesComponent:[function(t,e,o){"use strict";cc._RF.push(e,"e0beanKYb9BarLVfKX/wfgx","dicesComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.diceSides=[],e.dices=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.runAnimation=function(t){var e=this;console.log("resutls:",t),this.dices.forEach(function(t,e){t.getComponent(cc.Animation).play()}),t.forEach(function(o,n){setTimeout(function(){console.log(t),e.dices[n].getComponent(cc.Animation).stop(),e.dices[n].getComponent(cc.Sprite).spriteFrame=e.diceSides[o-1]},1e3+350*n)})},i([c(cc.SpriteFrame)],e.prototype,"diceSides",void 0),i([c(cc.Node)],e.prototype,"dices",void 0),e=i([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],gamecontroller:[function(t,e,o){"use strict";cc._RF.push(e,"95a88MkojhBiLO4pKXFwAe8","gamecontroller");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./gameview"),c=t("./gamemodel"),a=t("../../../meliorgames/statemachine"),l=t("../../appmodel"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e.model=null,e.stateMachine=null,e._isblock=!1,e.runTimer=function(){var t=60;e._timerID=setInterval(function(){if(t--,e.view.timer.updateTimer(t),0===t){clearInterval(e._timerID),e._isblock=!0;var o=[e.getRandomIntInclusive(1,6),e.getRandomIntInclusive(1,6),e.getRandomIntInclusive(1,6)];e.view.dices.runAnimation(o),e.model.results=o.slice(),e.model.setChanged(),setTimeout(function(){e.runNewRound()},5e3)}},1e3)},e}return n(e,t),e.prototype.onLoad=function(){cc.sys.isMobile||(cc.Canvas.instance.fitHeight=!0);var t=cc.view._frameSize;cc.view.setFrameSize(t.width-1,t.height),cc.view.setFrameSize(t.width+1,t.height)},e.prototype.start=function(){var t=this;this.stateMachine=new a.default(this.node),this.model=new c.default(l.default.instance.player,l.default.instance.table),this.model.slots=this.view.slots.map(function(t,e){return{id:t.slodId,chips:[]}}),this.view.slots.forEach(function(e){e.node.on("click",function(e){if(console.log("click",e),!t._isblock){var o=t.model.findActiveChip();o&&(t.model.balance<o.value||(t.model.balance-=o.value,t.model.totalBet+=o.value,t.model.addChipToSlot(e,o),console.log(t.model.balance),t.model.setChanged()))}})}),this.view.chipsContainer.node.on("selected",function(e){console.log("selected chip",e),t.model.selecteChip(e),t.model.setChanged()}),this.view.confirmBtn.on("touchstart",function(){console.log("confirmBtn")}),this.view.cancelBtn.on("touchstart",function(){console.log("cancelBtn"),t.model.slots=t.model.slots.map(function(t){return i({},t,{chips:[]})}),t.model.setChanged()}),this.view.applyModel(this.model),this.runTimer()},e.prototype.runNewRound=function(){this.model.slots=this.model.slots.map(function(t){return i({},t,{chips:[]})}),this.model.totalBet=0,this.model.setChanged(),this.runTimer(),this._isblock=!1},e.prototype.getRandomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},e.prototype.getRandomFloatInclusive=function(t,e){return Math.random()*(e-t+1)+t},s([d(r.default)],e.prototype,"view",void 0),e=s([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../meliorgames/statemachine":"statemachine","../../appmodel":"appmodel","./gamemodel":"gamemodel","./gameview":"gameview"}],gamejoinstate:[function(t,e,o){"use strict";cc._RF.push(e,"16524z/srJK1YM7qQ8Xxacl","gamejoinstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./gamestate"),s=t("../../../net/livecasinoapp"),r=t("./gameplaystate"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){var o=this;t.prototype.onStart.call(this,e);var n=this;s.default.instance.startGame().then(function(t){var e=JSON.parse(t.rpc.payload);cc.warn(e),o.model.attempt=e.TraysLeft,o.model.startAmounts=e.Amounts,o.model.startBalls=e.Balls,n.controller.stateMachine.applyState(r.default)})},e}(i.default);o.default=c,cc._RF.pop()},{"../../../net/livecasinoapp":"livecasinoapp","./gameplaystate":"gameplaystate","./gamestate":"gamestate"}],gamemodel:[function(t,e,o){"use strict";cc._RF.push(e,"ef3579m8xxMPqNzVrHpmAHQ","gamemodel");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(e,o){var n=t.call(this)||this;return n.table=null,n.player=null,n.slots=[],n.balance=999999,n.totalBet=0,n.results=[3,3,3],n.chips=[{id:0,selected:!1,value:1},{id:1,selected:!1,value:5},{id:2,selected:!1,value:10},{id:3,selected:!1,value:20},{id:4,selected:!1,value:50},{id:5,selected:!1,value:100},{id:6,selected:!1,value:500},{id:7,selected:!1,value:1e3},{id:8,selected:!1,value:2e3},{id:9,selected:!1,value:5e3}],n.roundId=-1,n}return n(e,t),e.prototype.selecteChip=function(t){this.chips=this.chips.map(function(e){return i({},e,{selected:e.id===t})})},e.prototype.findActiveChip=function(){return this.chips.find(function(t){return t.selected})},e.prototype.addChipToSlot=function(t,e){var o=this.slots.map(function(o){return console.log(t,e),o.id===t?i({},o,{chips:o.chips.concat([i({},e,{shortId:""})])}):i({},o)});this.slots=o},e.prototype.getRandomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},e.prototype.getRandomFloatInclusive=function(t,e){return Math.random()*(e-t+1)+t},e}(t("../../../meliorgames/observable").default);o.default=s,cc._RF.pop()},{"../../../meliorgames/observable":"observable"}],gameplaystate:[function(t,e,o){"use strict";cc._RF.push(e,"3388fgxnXBPlJTtNbLjQ9GM","gameplaystate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./gamestate"),s=t("../../../net/livecasinoapp"),r=t("./gameresultstate"),c=t("../../soundmanager"),a=["empty","plus","red","red","red","gold","green"],l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._coins=[],e._targetCoinId=-1,e._numberSoundFly=0,e.isPlayingAnimation=!1,e.isPlayingFly=!1,e.isClicked=!1,e}return n(e,t),e.prototype.onStart=function(e){var o=this;t.prototype.onStart.call(this,e),this.model.startBalls.length>0&&this.scheduleOnce(this.updateBalls,1.5),this.model.amounts=null,this.isClicked=!0,this.view.coins.forEach(function(t){t.node.on("click",o.onClick,o),t.node.on("onAnimationCompleted",o.onAnimationCompleted,o)}),this.scheduleOnce(function(){o.isClicked=!1,o.runLastClickTimer()},1.8),this.node.on("coinFlyCompleted",this.onCoinFlyCompleted,this),this.model.setChanged()},e.prototype.onCoinFlyCompleted=function(t){var e=this,o=t.target.getComponent("coinFlyComponent"),n=this.model.getCoinById(o.getCoinId());this.model.getCoinById(o.getTargetCoinId()).addValue(n.getValue()),this.model.addTotal(n.getValue()),this.scheduleOnce(function(){return e.runCoinFly()},.1),this.model.setChanged()},e.prototype.runCoinFly=function(){var t=this;if(0===this._coins.length)return this._numberSoundFly=0,this._lastTypeFlyCoin=void 0,this.isPlayingFly=!1,this.runLastClickTimer(),void(this.isClicked&&this.scheduleOnce(function(){return t.onGameFinish()},1.5));var e=this._coins.pop();this._numberSoundFly>8&&(this._numberSoundFly=0),this._lastTypeFlyCoin&&this._lastTypeFlyCoin!==e.getType()&&(this._numberSoundFly=0);var o=0;switch(e.getType()){case"red":o=-.13,c.default.play(c.SoundEffect.RedCoinFlyOne+this._numberSoundFly);break;case"green":c.default.play(c.SoundEffect.GreenCoinFlyOne+this._numberSoundFly);break;case"gold":c.default.play(c.SoundEffect.GoldCoinFlyOne+this._numberSoundFly)}this._numberSoundFly++,this._lastTypeFlyCoin=e.getType(),this.view.runCoinFly(e.getId(),this._targetCoinId,o)},e.prototype.updateBalls=function(){var t=this;console.log(this.model.startBalls),this.model.startBalls.forEach(function(e){var o=e.Number;if(t.model.getCoinById(o)){var n=a[e.Type];t.model.activateCoin(o,n,e.Win)}}),this.model.setChanged()},e.prototype.stopLastClickTimer=function(){this._timerLastClick&&clearTimeout(this._timerLastClick)},e.prototype.runLastClickTimer=function(){var t=this;this.stopLastClickTimer(),console.log("run last click timer"),this._timerLastClick=setTimeout(function(){for(;;){var e=t.getRandomIntInclusive(0,t.model.coins.length-1),o=t.model.coins[e];if(!o.isActive()){t.onClick(o.getId());break}}},16e3)},e.prototype.onClick=function(t){var e=this;if(!(this.isPlayingAnimation||this.isPlayingFly||!this.model.canPlay||this.isClicked)){this.isClicked=!0;var o=this.model.getCoinById(t);o&&!o.isActive()&&(this.stopLastClickTimer(),s.default.instance.bet(t).then(function(t){return e.bet(t)}).catch(function(t){console.error(t),e.runLastClickTimer()}))}},e.prototype.bet=function(t){var e,o,n=this;cc.warn("BET");var i=JSON.parse(t.rpc.payload);cc.warn(i);var s=a[i.Ball.Type],r=i.Ball.Number,c=i.Ball.Win;switch(s){case"gold":this.model.activateCoin(r,"gold",0),this._coins=this.model.getActiveCoinByType("red"),this._targetCoinId=r,this.scheduleOnce(function(){return n.runCoinFly()},2),this.isPlayingFly=!0;break;case"green":this._targetCoinId=r,this._coins=this.model.getActiveCoinByType("green"),(e=this._coins).push.apply(e,this.model.getActiveCoinByType("gold")),(o=this._coins).push.apply(o,this.model.getActiveCoinByType("red")),this.model.activateCoin(r,"green",0),this.scheduleOnce(function(){return n.runCoinFly()},2),this.isPlayingFly=!0;break;case"red":this.model.activateCoin(r,"red",c),this.runLastClickTimer();break;case"empty":this.model.setEmpty(r,"empty"),this.runLastClickTimer();break;case"plus":this.model.setPlus(r,"plus"),this.runLastClickTimer();break;default:return}this.model.setAttempt(i.TraysLeft),this.isPlayingAnimation=!0,this.animationFinishedTimer&&clearTimeout(this.animationFinishedTimer),this.model.setChanged(),this.isClicked=i.GameOver,i.GameOver&&(this.model.result=i,this.isPlayingFly||this.scheduleOnce(function(){return n.onGameFinish()},1.5))},e.prototype.getRandomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},e.prototype.onAnimationCompleted=function(t){var e=this,o=this.model.getCoinById(t);console.log("#id",t),o.isEmpty()?o.setEmpty(void 0):o.isPlus()?o.setPlus(void 0):o.isActive()&&this.model.addTotal(o.getValue()),this.animationFinishedTimer&&clearTimeout(this.animationFinishedTimer),this.animationFinishedTimer=setTimeout(function(){e.isPlayingAnimation=!1,e.animationFinishedTimer=null},500),this.model.setChanged()},e.prototype.onGameFinish=function(t){console.log("GAME FINISHED"),c.default.play(c.SoundEffect.End),this.controller.stateMachine.applyState(r.default,[this.controllerClass])},e.prototype.onReleaseResources=function(){var e=this;this.animationFinishedTimer&&clearTimeout(this.animationFinishedTimer),this._timerLastClick&&clearTimeout(this._timerLastClick),this.view.coins.forEach(function(t){t.node.off("click",e.onClick,e),t.node.off("onAnimationCompleted",e.onAnimationCompleted,e)}),this.node.off("coinFlyCompleted",this.onCoinFlyCompleted,this),t.prototype.onReleaseResources.call(this)},e}(i.default);o.default=l,cc._RF.pop()},{"../../../net/livecasinoapp":"livecasinoapp","../../soundmanager":"soundmanager","./gameresultstate":"gameresultstate","./gamestate":"gamestate"}],gameresultstate:[function(t,e,o){"use strict";cc._RF.push(e,"c74cdDQ7qxGy7B78BeWNXhY","gameresultstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./gamestate"),s=t("./gameplaystate"),r=t("../../../net/livecasinoapp"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){var o=this;t.prototype.onStart.call(this,e),this.model.canPlay&&(this.node.on("winPopupFinished",this.onGameStart,this),this.model.canPlay=!1,this.model.setChanged(),this.scheduleOnce(function(){o.view.showWinPopup(o.model.result.TotalWin)},2.5))},e.prototype.onGameStart=function(t){var e=this;this.model.result={},this.model.canPlay=!0,this.model.initNewRound(),this.model.setChanged(),console.log("Game start new");var o=this;r.default.instance.startGame().then(function(t){cc.warn("RESULT"),cc.warn(t);var n=JSON.parse(t.rpc.payload);o.model.startAmounts=n.Amounts,o.model.startBalls=n.Balls,o.controller.stateMachine.applyState(s.default,[e.controllerClass])})},e.prototype.onReleaseResources=function(){this.node.off("winPopupFinished",this.onGameStart,this)},e}(i.default);o.default=c,cc._RF.pop()},{"../../../net/livecasinoapp":"livecasinoapp","./gameplaystate":"gameplaystate","./gamestate":"gamestate"}],gamestate:[function(t,e,o){"use strict";cc._RF.push(e,"0ab499ifv9H3qoFRZBwjtQO","gamestate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.controller=null,e.model=null,e.view=null,e.controllerClass="gamecontroller",e}return n(e,t),Object.defineProperty(e.prototype,"isGameScene",{get:function(){return"game"==cc.director.getScene().name},enumerable:!0,configurable:!0}),e.prototype.onStart=function(t){0!=this.args.length&&(this.controllerClass=this.args[0],cc.log("Defined custom component:"+this.controllerClass)),this.controller=this.node.getComponent(this.controllerClass),this.view=this.controller.view,this.model=this.controller.model},e.prototype.applyGame=function(t){},e}(t("../../../../meliorgames/command").default);o.default=i,cc._RF.pop()},{"../../../../meliorgames/command":"command"}],gametable:[function(t,e,o){"use strict";cc._RF.push(e,"c6b89MPvc1DTJDeuGruRHTF","gametable"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(t){this.name=null,this.key=null,this.game=null,this.min_balance=0,this.odds=null,this.history=[],this.chips=null,this.stake={min:0,max:0},this.stakeLeft=0,this.tableUpdated=!0,this.players_min_limit=0,this.countdownTimer=60,this.TraysLeft=5,Object.assign(this,t),this.stakeLeft=this.stake.max}}();o.default=n,cc._RF.pop()},{}],gameview:[function(t,e,o){"use strict";cc._RF.push(e,"57abfpoTjRHSZVMIea+7ekP","gameview");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./components/slotComponent"),r=t("./components/chipsContainerComponent"),c=t("./components/timerComponent"),a=t("./components/dicesComponent"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tables=[],e.slots=[],e.chipsContainer=null,e.timer=null,e.dices=null,e.balance=null,e.totalBet=null,e.resultLabels=[],e.resultLable=null,e.resultTextLabel=null,e.confirmBtn=null,e.cancelBtn=null,e.switchBtns=[],e.closeDrawHistoryBtn=null,e.menuBtn=null,e.drawHistoryPopup=null,e.chipPrefab=null,e._chips=[],e}return n(e,t),e.prototype.start=function(){var t=this;this.drawHistoryPopup.active=!1,this.slots.forEach(function(e){return e.chipPrefab=t.chipPrefab}),this.switchBtns.forEach(function(e){e.on("touchstart",function(){t.tables[0].active=!t.tables[0].active,t.tables[1].active=!t.tables[1].active,t.switchBtns[0].active=!t.switchBtns[0].active,t.switchBtns[1].active=!t.switchBtns[1].active})}),this.menuBtn.on("touchstart",function(){t.drawHistoryPopup.active=!0}),this.closeDrawHistoryBtn.on("touchstart",function(){t.drawHistoryPopup.active=!1})},e.prototype.applyModel=function(t){var e=this;t&&t.removeObserver(this),t.addObserver(this),this.chipsContainer.applyModel(t),this._chips.forEach(function(t){return e.node.removeChild(t)}),this.slots.forEach(function(e){return e.applyModel(t)}),this.onObjectChanged(t)},e.prototype.onObjectChanged=function(t){var e=this;console.log(t),this.balance.string=t.balance.toString(),this.totalBet.string=t.totalBet.toString();var o=t.results;t.results.map(function(t,o){e.resultLabels[o].string=t.toString()});var n=o.reduce(function(t,e){return t+e});this.resultLable.string=n.toString(),this.resultTextLabel.string=n<11?"\u5c0f":"\u5927"},e.prototype.addChips=function(t,e){var o=this.slots[t];o.addChip(e,this.chipPrefab);var n=this.node.convertToNodeSpaceAR(o.node.parent.convertToWorldSpaceAR(o.node.position));console.log(n)},i([p(cc.Node)],e.prototype,"tables",void 0),i([p(s.default)],e.prototype,"slots",void 0),i([p(r.default)],e.prototype,"chipsContainer",void 0),i([p(c.default)],e.prototype,"timer",void 0),i([p(a.default)],e.prototype,"dices",void 0),i([p(cc.Label)],e.prototype,"balance",void 0),i([p(cc.Label)],e.prototype,"totalBet",void 0),i([p(cc.Label)],e.prototype,"resultLabels",void 0),i([p(cc.Label)],e.prototype,"resultLable",void 0),i([p(cc.Label)],e.prototype,"resultTextLabel",void 0),i([p(cc.Node)],e.prototype,"confirmBtn",void 0),i([p(cc.Node)],e.prototype,"cancelBtn",void 0),i([p(cc.Node)],e.prototype,"switchBtns",void 0),i([p(cc.Node)],e.prototype,"closeDrawHistoryBtn",void 0),i([p(cc.Node)],e.prototype,"menuBtn",void 0),i([p(cc.Node)],e.prototype,"drawHistoryPopup",void 0),i([p(cc.Prefab)],e.prototype,"chipPrefab",void 0),e=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./components/chipsContainerComponent":"chipsContainerComponent","./components/dicesComponent":"dicesComponent","./components/slotComponent":"slotComponent","./components/timerComponent":"timerComponent"}],identitymap:[function(t,e,o){"use strict";cc._RF.push(e,"26801T5FoZPm6yihYcDSa7j","identitymap"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.items={}}return t.prototype.register=function(t){var e=this.getKey(t),o=this.items[e];return o?(cc.log("Found duplicate:"+e),cc.log(o),this.merge(t,o)):(this.items[e]=t,o=t),o},t}();o.default=n,cc._RF.pop()},{}],livecasinoapp:[function(t,e,o){"use strict";cc._RF.push(e,"389c2rkYBhImpva4Gj8eSm4","livecasinoapp");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../meliorgames/statemachine"),r=t("./states/livecasinologinstate"),c=t("./states/livecasinoloadprofilestate"),a=t("./states/livecasinoconnectstate"),l=t("./states/livecasinojoinstate"),u=cc._decorator.ccclass,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateMachine=null,e.client=null,e.session=null,e.socket=null,e.connected=!1,e.account=null,e.token=null,e.external_token=null,e.external_user_id=null,e.external_avatar_url=null,e.configPath=null,e.lobbySettings=null,e.isLostConnection=!1,e.reconnectTries=0,e.tableId=null,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,cc.game.addPersistRootNode(this.node),this.stateMachine=new s.default(this.node)},e.prototype.connectToServer=function(){if(null==this.client){var t=this,e=cc.sys.localStorage.getItem("email"),o=cc.sys.localStorage.getItem("password");if(e||(e="player-"+Math.floor(Math.random()*Math.floor(1e3))+"@meliorgames.com",o="p4323242342",cc.sys.localStorage.setItem("email",e),cc.sys.localStorage.setItem("password",o)),cc.log("Login with credentials:"+e+":"+o),this.external_token=o,this.external_user_id=e,console.log("Token = "+this.external_token+"\nuser_id = "+this.external_user_id),console.log("Avatar URL = "+this.external_avatar_url),null!=this.configPath){var n=new XMLHttpRequest;n.onload=function(){var e=JSON.parse(n.responseText);console.log("Server is: "+e.server),t.client=new nakamajs.Client(e.data.defaultkey,e.server,e.data.port),t.client.ssl=!1},n.open("get",this.configPath,!0),n.send()}t.client=new nakamajs.Client("defaultkey","cdn.meliorgames.com",7450),t.client.ssl=!1}},e.prototype.getAccount=function(){return this.client.getAccount(this.session)},e.prototype.updateAccount=function(t){return this.client.updateAccount(this.session,{display_name:t.display_name,avatar_url:t.avatar_url})},e.prototype.connect=function(){return this.socket&&this.socket.disconnect(),this.socket=this.client.createSocket(!1,!1),this.socket.ondisconnect=this.onDisconnect.bind(this),this.socket.onconnected=this.onConnected.bind(this),this.socket.onchannelmessage=this.onChannelMessage,this.socket.onmatchdata=this.onMatchData.bind(this),this.socket.onnotification=this.onNotification.bind(this),this.socket.onstreamdata=this.onStreamData.bind(this),this.stateMachine.applyState(a.default,[])},e.prototype.onStreamData=function(t){10==t.stream.mode?(cc.log("Received lobby message:"+t.data),this.node.emit("lobby",JSON.parse(t.data))):100==t.stream.mode&&this.node.emit("server_debug",JSON.parse(t.data))},e.prototype.integrate=function(t){this.socket.send({match_data_send:{match_id:t,op_code:200,data:{user_id:this.external_user_id,token:this.external_token,avatar:this.external_avatar_url,game:"dragonvstiger"}}})},e.prototype.getMatchId=function(){return this.socket.send({rpc:{id:"create_match",payload:JSON.stringify({TableId:"smg3"})}})},e.prototype.onMatchData=function(t){var e=t.data;switch(cc.log(t),t.op_code){case 101:cc.log("Match is finished, cards:"+JSON.stringify(e)),this.node.emit("finish",t);break;case 102:cc.log("Bets started, timeout:"+JSON.stringify(e)),this.node.emit("start",t);break;case 103:cc.log("user joined:"+JSON.stringify(e)),this.node.emit("join",t);break;case 104:cc.log("board updated:"+JSON.stringify(e)),this.node.emit("board",t);break;case 1:this.node.emit("bet",t);break;case 2:this.node.emit("welcome",t);break;case 151:this.node.emit("house-update",t);break;case 105:this.node.emit("room-update",t);break;case 199:break;case 200:this.node.emit("player-update",t.data.player);break;case 222:this.node.emit("ping-update",t.data.send_time);break;default:cc.log("Unhandled message "+JSON.stringify(t))}},e.prototype.onDisconnect=function(t){console.log("Disconnected"),o.instance&&this.node.emit("disconnected")},e.prototype.onConnected=function(t){cc.log("Connected"),this.node.emit("connected")},e.prototype.follow=function(t){this.socket.send({status_follow:{user_ids:t}})},e.prototype.unfollow=function(t){this.socket.send({status_unfollow:{user_ids:t}})},e.prototype.onNotification=function(t){cc.log("Received notification "+JSON.stringify(t)),2==t.code&&this.node.emit("welcome",t.content)},e.prototype.onChannelMessage=function(t){cc.log("Message received from channel",t.channel_id),cc.log("Received message",t)},e.prototype.bet=function(t){return this.socket.send({rpc:{id:"match_bet",payload:JSON.stringify({ball:t,TableId:this.tableId,GameName:"fivetouchesremaining"})}})},e.prototype.getTables=function(){return this.socket.send({rpc:{id:"game_tables",payload:JSON.stringify({GameName:"fivetouchesremaining"})}})},e.prototype.startGame=function(){return this.socket.send({rpc:{id:"start_game",payload:JSON.stringify({TableId:this.tableId,GameName:"fivetouchesremaining"})}})},e.prototype.join=function(){return this.stateMachine.execute(l.default,[])},e.prototype.loadProfile=function(){return this.stateMachine.applyState(c.default,[])},e.prototype.login=function(t){return this.stateMachine.applyState(r.default,[t])},e.instance=null,e=o=i([u],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../meliorgames/statemachine":"statemachine","./states/livecasinoconnectstate":"livecasinoconnectstate","./states/livecasinojoinstate":"livecasinojoinstate","./states/livecasinoloadprofilestate":"livecasinoloadprofilestate","./states/livecasinologinstate":"livecasinologinstate"}],livecasinoconnectstate:[function(t,e,o){"use strict";cc._RF.push(e,"f71c0zWIIVOd4YIAcYuAP40","livecasinoconnectstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./livecasinostate"),s=t("./livecasinoreconnectstate"),r=t("./livecasinoloadprofilestate"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e);var o=this;this.app.socket.connect(this.app.session).then(function(){o.app.stateMachine.applyState(r.default)}).catch(function(t){cc.log(t),o.app.stateMachine.applyState(s.default)})},e.prototype.getName=function(){return"LiveCasinoConnectState"},e}(i.default);o.default=c,cc._RF.pop()},{"./livecasinoloadprofilestate":"livecasinoloadprofilestate","./livecasinoreconnectstate":"livecasinoreconnectstate","./livecasinostate":"livecasinostate"}],livecasinodisconnectedstate:[function(t,e,o){"use strict";cc._RF.push(e,"66fc2U/dg5MxZOD7L7tddVd","livecasinodisconnectedstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e)},e.prototype.getName=function(){return"LiveCasinoDisconnectedState"},e}(t("./livecasinostate").default);o.default=i,cc._RF.pop()},{"./livecasinostate":"livecasinostate"}],livecasinohearbeatstate:[function(t,e,o){"use strict";cc._RF.push(e,"4f477Yf6+tE4ZBiW+z2E8+5","livecasinohearbeatstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.socket=null,e.token=null,e}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e),this.socket&&this.socket.close(),this.app.isLostConnection&&this.app.node.emit("reconnected")},e.prototype.login=function(){var t={cmd:"login",userId:this.app.external_user_id,token:this.app.external_token,room:"roomId"};this.socket.send(JSON.stringify({cmd:"connection",appid:"appid"})),this.socket.send(JSON.stringify(t)),this.unschedule(this.heart),this.schedule(this.heart,5,cc.macro.REPEAT_FOREVER)},e.prototype.heart=function(){var t={cmd:"heart",userId:this.app.external_user_id,token:this.app.external_token,room:"roomId"};this.socket.send(JSON.stringify(t))},e.prototype.onMessage=function(t){var e=JSON.parse(t.data);cc.log("CODE = "+e.code+"    MESSAGE = "+e.message)},e.prototype.getName=function(){return"LiveCasinoHeartBeatState"},e}(t("./livecasinostate").default);o.default=i,cc._RF.pop()},{"./livecasinostate":"livecasinostate"}],livecasinointegratestate:[function(t,e,o){"use strict";cc._RF.push(e,"7b0acr2ROhCVKSIhvKaQika","livecasinointegratestate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./livecasinostate"),s=t("./livecasinoloadprofilestate"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e);this.app.stateMachine.applyState(s.default)},e.prototype.getName=function(){return"LiveCasinoIntegrateState"},e}(i.default);o.default=r,cc._RF.pop()},{"./livecasinoloadprofilestate":"livecasinoloadprofilestate","./livecasinostate":"livecasinostate"}],livecasinojoinstate:[function(t,e,o){"use strict";cc._RF.push(e,"d6483wgVYdGd7EVMzxXp//1","livecasinojoinstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.match=null,e.timeout=0,e.duration=0,e.history=[],e.round=0,e.players=[],e.bets=[],e.house_queue=[],e.host=null,e.welcome=null,e.welcome_received=!1,e}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e);var o=this;this.app.node.on("welcome",this.onWelcome,this),cc.log("Joining to desk:"+e[0]+", type:"+e[1]),this.app.client.rpc(this.app.session,"creategame",{desk:e[0],game:e[1]}).then(function(t){cc.log("Game created:"+JSON.stringify(t)),o.app.socket.send({match_join:{match_id:t.payload.match_id}}).then(function(t){cc.log("Joined to match:"+JSON.stringify(t)),o.match=t.match,o.welcome_received&&o.finishCommand()}).catch(function(t){cc.log("Enable to join game:"+JSON.stringify(t))})}).catch(function(t){cc.log("Unable to create game:"+JSON.stringify(t))})},e.prototype.onWelcome=function(t){cc.log("Received welcome message"),this.app.node.off("welcome",this.onWelcome,this),this.timeout=t.timeout,this.duration=t.duration,this.round=t.round,this.players=t.players,this.host=t.host,Array.isArray(t.history)&&(this.history=t.history),Array.isArray(t.house_queue)&&(this.house_queue=t.house_queue),Array.isArray(t.bets)&&(this.bets=t.bets),this.welcome=t,this.welcome_received=!0,this.match&&this.finishCommand()},e.prototype.getName=function(){return"LiveCasinoJoinState"},e}(t("../states/livecasinostate").default);o.default=i,cc._RF.pop()},{"../states/livecasinostate":"livecasinostate"}],livecasinoloadprofilestate:[function(t,e,o){"use strict";cc._RF.push(e,"790bf2skOJHI6KAPiLk1Zkg","livecasinoloadprofilestate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./livecasinostate"),s=t("./livecasinohearbeatstate"),r=t("./livecasinoconnectstate"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e);var o=this;this.app.client.getAccount(this.app.session).then(function(t){o.app.account=t,cc.log("Account:"+JSON.stringify(t)),o.app.stateMachine.applyState(s.default)}).catch(function(t){cc.log(t),localStorage.removeItem("nakamaAuthToken"),o.app.stateMachine.applyState(r.default)})},e.prototype.getName=function(){return"LiveCasinoLoadProfileState"},e}(i.default);o.default=c,cc._RF.pop()},{"./livecasinoconnectstate":"livecasinoconnectstate","./livecasinohearbeatstate":"livecasinohearbeatstate","./livecasinostate":"livecasinostate"}],livecasinologinstate:[function(t,e,o){"use strict";cc._RF.push(e,"d4fedeOZAJJKL3pcxZiUQjQ","livecasinologinstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./livecasinostate"),s=t("./livecasinoreconnectstate"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.response=null,e}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e),this.login()},e.prototype.login=function(){var t=this;if(t.app.session){var e=nakamajs.Session.restore(t.app.session.token),o=(new Date).getTime()/1e3;if(!e.isexpired(o))return t.app.session=e,void t.app.connect()}t.app.client.authenticateCustom({id:t.app.external_user_id,create:!0}).then(function(e){t.app.session=e,t.app.connect()}).catch(function(e){cc.log("Unable to authenticate"),cc.log(e),localStorage.removeItem("nakamaAuthToken"),t.app.stateMachine.applyState(s.default)})},e.prototype.getName=function(){return"LiveCasinoLoginState"},e}(i.default);o.default=r,cc._RF.pop()},{"./livecasinoreconnectstate":"livecasinoreconnectstate","./livecasinostate":"livecasinostate"}],livecasinoonlinestate:[function(t,e,o){"use strict";cc._RF.push(e,"cd36c1hw4pGEqXst//zj0R1","livecasinoonlinestate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getName=function(){return"LiveCasinoOnlineState"},e}(t("./livecasinostate").default);o.default=i,cc._RF.pop()},{"./livecasinostate":"livecasinostate"}],livecasinoreconnectstate:[function(t,e,o){"use strict";cc._RF.push(e,"2513fk5sONJQb2DjlCvWNnh","livecasinoreconnectstate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("./livecasinostate"),s=t("./livecasinologinstate"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=1e3,e.finishAt=0,e}return n(e,t),e.prototype.onStart=function(e){t.prototype.onStart.call(this,e),this.finishAt=(new Date).getTime()+this.delay},e.prototype.onUpdate=function(t){this.finishAt<(new Date).getTime()&&(this.app.reconnectTries+=1,this.app.stateMachine.applyState(s.default))},e.prototype.getName=function(){return"LiveCasinoReconnectState"},e}(i.default);o.default=r,cc._RF.pop()},{"./livecasinologinstate":"livecasinologinstate","./livecasinostate":"livecasinostate"}],livecasinostate:[function(t,e,o){"use strict";cc._RF.push(e,"9b152ynJqpMvKkxgbBfQVg1","livecasinostate");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../meliorgames/command"),s=t("../livecasinoapp"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.app=null,e}return n(e,t),e.prototype.onStart=function(t){this.app=this.node.getComponent(s.default)},e}(i.default);o.default=r,cc._RF.pop()},{"../../../meliorgames/command":"command","../livecasinoapp":"livecasinoapp"}],localizationlabel:[function(t,e,o){"use strict";cc._RF.push(e,"1b901ZnQPhJl4CE4gMmTW8m","localizationlabel");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator.ccclass,r=cc._decorator.property,c=t("./localization"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e}return n(e,t),e.prototype.start=function(){c.default.instance&&(this.string=c.default.getString(this.key))},i([r],e.prototype,"key",void 0),e=i([s],e)}(cc.Label);o.default=a,cc._RF.pop()},{"./localization":"localization"}],localization:[function(t,e,o){"use strict";var n;cc._RF.push(e,"f75a9Iot6RDa6slmIIrUpov","localization"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.English=0]="English",t[t.Chinese=1]="Chinese"}(n=o.LocalizationLang||(o.LocalizationLang={}));var i=function(){function t(){t.instance=this}return t.load=function(e){return new t,new Promise(function(o,n){cc.loader.loadRes(e,function(e,n){e?console.log(e):n&&(t.map=n.json),o()})})},t.getString=function(e){var o=[];if(!t.map)return e;Array.isArray(t.map[e])&&(o=t.map[e]);var n=o[this.currentLanguage];return n||(cc.warn("Localization key "+e+" not found"),e)},t.currentLanguage=n.Chinese,t.instance=null,t}();o.default=i,cc._RF.pop()},{}],observable:[function(t,e,o){"use strict";cc._RF.push(e,"10b5frfYexJ8oittJNPUHos","observable"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.observers=[]}return t.prototype.setChanged=function(){for(var t=0;t<this.observers.length;t++)this.observers[t].onObjectChanged(this)},t.prototype.addObserver=function(t){this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);-1!=e&&this.observers.splice(e,1)},t}();o.default=n,cc._RF.pop()},{}],player:[function(t,e,o){"use strict";cc._RF.push(e,"f6750SdbfpCppTG4kJpKlpu","player");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../meliorgames/observable"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getKey=function(t){return t.user_id},e.prototype.merge=function(t,e){e.merge(t)},e}(t("../../meliorgames/identitymap").default);o.PlayerIM=s;var r=function(t){function e(e){var o=t.call(this)||this;return o.user_id=e.user_id,e.display_name||(o.display_name=o.encodeUTF8("\u7528\u6237"+Math.floor(1e8*Math.random()))),o.merge(e),o}return n(e,t),e.prototype.merge=function(t){if(this.user_id&&t.user_id!=this.user_id)throw new Error("Tried to merge player "+t.user_id+" to "+this.user_id);t.balance&&(this.balance=t.balance),t.username&&(this.username=t.username),t.display_name&&(this.display_name=t.display_name),t.avatar_url&&(this.avatar_url=t.avatar_url),t.metadata&&(this.metadata=t.metadata),t.title&&(this.title=t.title)},e.prototype.encodeUTF8=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},e}(i.default);o.default=r,cc._RF.pop()},{"../../meliorgames/identitymap":"identitymap","../../meliorgames/observable":"observable"}],slotComponent:[function(t,e,o){"use strict";cc._RF.push(e,"112001AdW9GL4pSGldmtidd","slotComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property;o.SlotTypes={1:"big",2:"small",3:"triple-1",4:"triple-2",5:"triple-5",6:"triple-3",7:"triple-4",8:"triple-6",9:"triple-any",10:"number-1",11:"number-2",12:"number-3",13:"number-4",14:"number-5",15:"number-6",16:"double-1",17:"double-2",18:"double-3",19:"double-4",20:"double-5",21:"double-6",22:"pair-1-2",23:"pair-1-3",24:"pair-1-4",25:"pair-1-5",26:"pair-1-6",27:"pair-2-3",28:"pair-2-4",29:"pair-2-5",30:"pair-2-6",31:"pair-3-4",32:"pair-3-5",33:"pair-3-6",34:"pair-4-5",35:"pair-4-6",36:"pair-5-6"};var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slodId=0,e.type=0,e.storeChips=[],e}return n(e,t),e.prototype.start=function(){var t=this;this.node.on("touchstart",function(){t.node.emit("click",t.slodId)},this)},e.prototype.applyModel=function(t){t&&t.removeObserver(this),t.addObserver(this),this.onObjectChanged(t)},e.prototype.onObjectChanged=function(t){var e=this,o=t.slots.find(function(t){return t.id===e.slodId});o&&(this.removeChips(),o.chips.forEach(function(t){e.addChip(t,e.chipPrefab)}))},e.prototype.addChip=function(t,e){var o=cc.instantiate(e);this.node.addChild(o);var n=o.getComponent("chipComponent"),i=0,s=0;n.isBlockSelected=!0,n.node.position=new cc.Vec3(i,s,0),n.node.width=32,n.node.height=32,n.setActiveChip(t.id),this.storeChips.push(o)},e.prototype.removeChips=function(){var t=this;this.storeChips.forEach(function(e){return t.node.removeChild(e)})},e.prototype.getRandomIntInclusive=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},e.prototype.getRandomFloatInclusive=function(t,e){return Math.random()*(e-t+1)+t},i([c(Number)],e.prototype,"slodId",void 0),i([c(Number)],e.prototype,"type",void 0),e=i([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],soundmanager:[function(t,e,o){"use strict";var n;cc._RF.push(e,"03efc8R2cdHEoUuyXZsLms1","soundmanager"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.BackgroundMusic=0]="BackgroundMusic",t[t.GoldCoinFlyOne=1]="GoldCoinFlyOne",t[t.GoldCoinFlyTwo=2]="GoldCoinFlyTwo",t[t.GoldCoinFlyThree=3]="GoldCoinFlyThree",t[t.GoldCoinFlyFour=4]="GoldCoinFlyFour",t[t.GoldCoinFlyFive=5]="GoldCoinFlyFive",t[t.GoldCoinFlySix=6]="GoldCoinFlySix",t[t.GoldCoinFlySeven=7]="GoldCoinFlySeven",t[t.GoldCoinFlyEight=8]="GoldCoinFlyEight",t[t.GreenCoinFlyOne=9]="GreenCoinFlyOne",t[t.GreenCoinFlyTwo=10]="GreenCoinFlyTwo",t[t.GreenCoinFlyThree=11]="GreenCoinFlyThree",t[t.GreenCoinFlyFour=12]="GreenCoinFlyFour",t[t.GreenCoinFlyFive=13]="GreenCoinFlyFive",t[t.GreenCoinFlySix=14]="GreenCoinFlySix",t[t.GreenCoinFlySeven=15]="GreenCoinFlySeven",t[t.GreenCoinFlyEight=16]="GreenCoinFlyEight",t[t.RedCoinFlyOne=17]="RedCoinFlyOne",t[t.RedCoinFlyTwo=18]="RedCoinFlyTwo",t[t.RedCoinFlyThree=19]="RedCoinFlyThree",t[t.RedCoinFlyFour=20]="RedCoinFlyFour",t[t.RedCoinFlyFive=21]="RedCoinFlyFive",t[t.RedCoinFlySix=22]="RedCoinFlySix",t[t.RedCoinFlySeven=23]="RedCoinFlySeven",t[t.RedCoinFlyEight=24]="RedCoinFlyEight",t[t.End=25]="End",t[t.CoinSelect=26]="CoinSelect",t[t.Count=27]="Count",t[t.GoldCoinExplode=28]="GoldCoinExplode",t[t.GreenCoinExplode=29]="GreenCoinExplode",t[t.RedCoinExplode=30]="RedCoinExplode",t[t.PurpleCoinExplode=31]="PurpleCoinExplode",t[t.X2CoinExplode=32]="X2CoinExplode",t[t.SignGlow=33]="SignGlow",t[t.OpenWinPopup=34]="OpenWinPopup"}(n=o.SoundEffect||(o.SoundEffect={}));var i=function(){function t(){this.effectsResources=[],this.order=[],this.isOrderPlaying=!1,this.soundEnabled=!0,this.effectsVolume=1,this.musicVolume=1,this.musicId=null,this.effectsResources[n.BackgroundMusic]={res:"Music_Base_Loop",clip:""},this.effectsResources[n.GoldCoinFlyOne]={res:"coinsFly/GoldCoin_Fly_1",clip:""},this.effectsResources[n.GoldCoinFlyTwo]={res:"coinsFly/GoldCoin_Fly_2",clip:""},this.effectsResources[n.GoldCoinFlyThree]={res:"coinsFly/GoldCoin_Fly_3",clip:""},this.effectsResources[n.GoldCoinFlyFour]={res:"coinsFly/GoldCoin_Fly_4",clip:""},this.effectsResources[n.GoldCoinFlyFive]={res:"coinsFly/GoldCoin_Fly_5",clip:""},this.effectsResources[n.GoldCoinFlySix]={res:"coinsFly/GoldCoin_Fly_6",clip:""},this.effectsResources[n.GoldCoinFlySeven]={res:"coinsFly/GoldCoin_Fly_7",clip:""},this.effectsResources[n.GoldCoinFlyEight]={res:"coinsFly/GoldCoin_Fly_8",clip:""},this.effectsResources[n.GreenCoinFlyOne]={res:"coinsFly/GreenCoin_Fly_1",clip:""},this.effectsResources[n.GreenCoinFlyTwo]={res:"coinsFly/GreenCoin_Fly_2",clip:""},this.effectsResources[n.GreenCoinFlyThree]={res:"coinsFly/GreenCoin_Fly_3",clip:""},this.effectsResources[n.GreenCoinFlyFour]={res:"coinsFly/GreenCoin_Fly_4",clip:""},this.effectsResources[n.GreenCoinFlyFive]={res:"coinsFly/GreenCoin_Fly_5",clip:""},this.effectsResources[n.GreenCoinFlySix]={res:"coinsFly/GreenCoin_Fly_6",clip:""},this.effectsResources[n.GreenCoinFlySeven]={res:"coinsFly/GreenCoin_Fly_7",clip:""},this.effectsResources[n.GreenCoinFlyEight]={res:"coinsFly/GreenCoin_Fly_8",clip:""},this.effectsResources[n.RedCoinFlyOne]={res:"coinsFly/RedCoin_Fly_1",clip:""},this.effectsResources[n.RedCoinFlyTwo]={res:"coinsFly/RedCoin_Fly_2",clip:""},this.effectsResources[n.RedCoinFlyThree]={res:"coinsFly/RedCoin_Fly_3",clip:""},this.effectsResources[n.RedCoinFlyFour]={res:"coinsFly/RedCoin_Fly_4",clip:""},this.effectsResources[n.RedCoinFlyFive]={res:"coinsFly/RedCoin_Fly_5",clip:""},this.effectsResources[n.RedCoinFlySix]={res:"coinsFly/RedCoin_Fly_6",clip:""},this.effectsResources[n.RedCoinFlySeven]={res:"coinsFly/RedCoin_Fly_7",clip:""},this.effectsResources[n.RedCoinFlyEight]={res:"coinsFly/RedCoin_Fly_8",clip:""},this.effectsResources[n.End]={res:"coinsFly/The_End",clip:""},this.effectsResources[n.CoinSelect]={res:"music/Coin_Select",clip:""},this.effectsResources[n.Count]={res:"music/Count",clip:""},this.effectsResources[n.GoldCoinExplode]={res:"music/GoldCoin_Explode",clip:""},this.effectsResources[n.GreenCoinExplode]={res:"music/GreenCoin_Explode",clip:""},this.effectsResources[n.PurpleCoinExplode]={res:"music/PurpleCoin_Explode",clip:""},this.effectsResources[n.RedCoinExplode]={res:"music/RedCoin_Explode",clip:""},this.effectsResources[n.SignGlow]={res:"music/Sign_Glow",clip:""},this.effectsResources[n.X2CoinExplode]={res:"music/X2Coin_Explode",clip:""},this.effectsResources[n.OpenWinPopup]={res:"win_popup",clip:""}}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.stopBackgroundMusic=function(){var e=t.instance;cc.audioEngine.stop(e.musicId),e.musicId=null},t.play=function(e){var o=t.instance;return cc.audioEngine.play(o.effectsResources[e].clip,!1,o.soundEnabled?o.effectsVolume:0)},t.stop=function(t){cc.audioEngine.stop(t)},t.playLoop=function(e){var o=t.instance;return cc.audioEngine.play(o.effectsResources[e].clip,!0,o.soundEnabled?o.effectsVolume:0)},t.playMusic=function(){var e=t.instance;e.musicId=cc.audioEngine.play(e.effectsResources[n.BackgroundMusic].clip,!0,e.soundEnabled?e.musicVolume:0)},t.playSequence=function(e){var o=t.play(e[0]);1!=e.length&&setTimeout(function(){t.playSequence(e.slice(1,e.length))},1e3*cc.audioEngine.getDuration(o))},t.setEffectsVolume=function(e){t.instance.effectsVolume=e},t.setMusicVolume=function(e){t.instance.musicVolume=e,cc.audioEngine.setVolume(t.instance.musicId,e)},t.setSoundEnabled=function(e){t.instance.soundEnabled=e,cc.audioEngine.setVolume(t.instance.musicId,e?t.instance.musicVolume:0)},t.preload=function(){return new Promise(function(e,o){for(var n=0,i=function(o){cc.loader.loadRes("sounds/"+t.instance.effectsResources[o].res,cc.AudioClip,function(i,s){t.instance.effectsResources[o].clip=s,n++,t.instance.effectsResources.length==n&&e()})},s=0;s<t.instance.effectsResources.length;s++)i(s)})},t._instance=null,t}();o.default=i,cc._RF.pop()},{}],soundsettings:[function(t,e,o){"use strict";cc._RF.push(e,"34647OJnnBDDLhZi0sLtNEg","soundsettings"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(t,e,o){this.music_volume=t,this.sfx_volume=e,this.enabled=o}}();o.default=n,cc._RF.pop()},{}],splashcontroller:[function(t,e,o){"use strict";cc._RF.push(e,"5454dPsxqdDQYC5ULGXZpTP","splashcontroller");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../appcontroller"),r=t("../../net/livecasinoapp"),c=t("../soundmanager"),a=t("../../appmodel"),l=t("../../domain/gametable"),u=t("../../domain/player"),p=t("../../net/states/livecasinodisconnectedstate"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.lbStatus=null,e.lostConnection=null,e.version=null,e.integrateError=null,e.counter=0,e.exitTimer=0,e.countdownTimer=30,e}return n(e,t),e.prototype.onLoad=function(){cc.sys.isMobile||(cc.Canvas.instance.fitHeight=!0),cc.view.setFrameSize(cc.view._frameSize.width-1,cc.view._frameSize.height),cc.view.setFrameSize(cc.view._frameSize.width+1,cc.view._frameSize.height),this.progressBar.progress=0,this.version.string="v1.0.0",r.default.instance.stateMachine.on("state-changed",this.onStateChanged,this),r.default.instance.stateMachine.on("integrate-error",this.onIntegrateError,this),this.lostConnection.active=r.default.instance.isLostConnection,this.schedule(this.onCheckGameIsUp,1,this.countdownTimer)},e.prototype.fastStart=function(){var t=this;Promise.all([c.default.preload()]).then(function(){t.progressBar.progress=.8,t.lbStatus.string="\u8d44\u6e90\u52a0\u8f7d\u4e2d...",cc.director.loadScene("game")})},e.prototype.onIntegrateError=function(){this.integrateError.active=!0},e.prototype.update=function(t){this.exitTimer+=t,0==this.lostConnection.active&&this.exitTimer>this.countdownTimer&&(r.default.instance.stateMachine.applyState(p.default),this.lostConnection.active=!0)},e.prototype.onCheckGameIsUp=function(){s.default.isHidden||null==r.default.instance||null==r.default.instance.client?(this.counter+=1,r.default.instance&&r.default.instance.connectToServer(),this.counter>=30&&(this.unschedule(this.onCheckGameIsUp),this.lostConnection.active=!0)):(null!=r.default.instance.lobbySettings&&(c.default.setMusicVolume(r.default.instance.lobbySettings.bgVol),c.default.setEffectsVolume(r.default.instance.lobbySettings.sfxVol)),this.unschedule(this.onCheckGameIsUp),r.default.instance.login(""))},e.prototype.onBackToLobby=function(){if(window.lobbyMgr){c.default.stopBackgroundMusic(),localStorage.removeItem("nakamaAuthToken"),this.unsubscribe(),cc.game.off(cc.game.EVENT_HIDE),cc.game.off(cc.game.EVENT_SHOW),r.default.instance.socket&&r.default.instance.socket.disconnect(),c.default._instance=null,a.default._instance=null;try{setTimeout(function(){cc.game.removePersistRootNode(r.default.instance.node),cc.game.removePersistRootNode(s.default.instance.node)},1e3)}catch(t){console.log("Error during release persist nodes")}window.lobbyMgr.backToLobby(!0)}},e.prototype.unsubscribe=function(){r.default.instance.stateMachine.off("state-changed",this.onStateChanged,this),r.default.instance.stateMachine.off("integrate-error",this.onIntegrateError,this)},e.prototype.onDestroy=function(){r.default.instance&&this.unsubscribe()},e.prototype.onStateChanged=function(t){var e=t.getName(),o={LiveCasinoDisconnectedState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:0},LiveCasinoLoginState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.1},LiveCasinoReconnectState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.2},LiveCasinoLoadProfileState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.4},LiveCasinoConnectState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.5},LiveCasinoIntegrateState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.6},LiveCasinoHeartBeatState:{name:"\u8d44\u6e90\u52a0\u8f7d\u4e2d...",progress:.7}};if(this.lbStatus.string=o[e].name,this.progressBar.progress=o[e].progress,"LiveCasinoHeartBeatState"==e){var n=new u.default(r.default.instance.account.user);n.user_id=r.default.instance.account.user.id,(n=a.default.instance.players.register(n)).balance=JSON.parse(r.default.instance.account.wallet).coins,n.metadata=JSON.parse(r.default.instance.account.user.metadata),n.title=0,s.default.instance.model.player=n;var i=this;Promise.all([c.default.preload()]).then(function(){i.progressBar.progress=.8,i.lbStatus.string="\u8d44\u6e90\u52a0\u8f7d\u4e2d...",r.default.instance.getTables().then(function(t){var e=JSON.parse(t.rpc.payload);if(Array.isArray(e)){var o=JSON.parse(e[0]);a.default.instance.table=new l.default(o),r.default.instance.tableId=o.key,i.lbStatus.string="\u8d44\u6e90\u52a0\u8f7d\u4e2d...",i.progressBar.progress=1,cc.director.loadScene("game")}else i.lbStatus.string="There are no games to join up."})})}},i([h(cc.ProgressBar)],e.prototype,"progressBar",void 0),i([h(cc.Label)],e.prototype,"lbStatus",void 0),i([h(cc.Node)],e.prototype,"lostConnection",void 0),i([h(cc.Label)],e.prototype,"version",void 0),i([h(cc.Node)],e.prototype,"integrateError",void 0),e=i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../appcontroller":"appcontroller","../../appmodel":"appmodel","../../domain/gametable":"gametable","../../domain/player":"player","../../net/livecasinoapp":"livecasinoapp","../../net/states/livecasinodisconnectedstate":"livecasinodisconnectedstate","../soundmanager":"soundmanager"}],statemachine:[function(t,e,o){"use strict";cc._RF.push(e,"5b5b7FdrA9O16NUtF9NaAh5","statemachine"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./command"),i=function(){function t(t){this._commands=[],this._state=null,this._container=t}return t.prototype.on=function(t,e,o){this._container.on(t,e,o)},t.prototype.off=function(t,e,o){this._container.off(t,e,o)},t.prototype.changeState=function(t,e){var o=this._state;return this._state=null,null!==o&&o.finishCommand(!0),this._state=this.createState(t,e),this._container.emit("state-changed",this._state),this._state.promise},t.prototype.applyState=function(t,e){return void 0===e&&(e=[]),this.changeState(t,e)},t.prototype.createState=function(t,e){var o=this._container.addComponent(t);return o.args=e,o},t.prototype.execute=function(t,e){return void 0===e&&(e=[]),n.default.executeOn(t,this._container,e,this._state)},t}();o.default=i,cc._RF.pop()},{"./command":"command"}],timerComponent:[function(t,e,o){"use strict";cc._RF.push(e,"2c143g/l8pFMJ1YyqBaeezB","timerComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num1=null,e.num2=null,e.numSprites=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.updateTimer=function(t){t--;var e=Math.floor(t/10),o=t%10;0!==e?(this.num1.getComponent(cc.Sprite).spriteFrame=this.numSprites[e],this.num1.active=!0,this.num2.x=14):(this.num1.active=!1,this.num2.x=0),this.num2.getComponent(cc.Sprite).spriteFrame=this.numSprites[o]},i([c(cc.Node)],e.prototype,"num1",void 0),i([c(cc.Node)],e.prototype,"num2",void 0),i([c(cc.SpriteFrame)],e.prototype,"numSprites",void 0),e=i([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}]},{},["command","identitymap","localization","localizationlabel","observable","statemachine","appcontroller","appmodel","coin","gametable","player","soundsettings","livecasinoapp","livecasinoconnectstate","livecasinodisconnectedstate","livecasinohearbeatstate","livecasinointegratestate","livecasinojoinstate","livecasinoloadprofilestate","livecasinologinstate","livecasinoonlinestate","livecasinoreconnectstate","livecasinostate","chipComponent","chipsContainerComponent","dicesComponent","slotComponent","timerComponent","gamecontroller","gamemodel","gameview","gamejoinstate","gameplaystate","gameresultstate","gamestate","soundmanager","splashcontroller"]);